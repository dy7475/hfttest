<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.myfun.repository.admindb.dao.AdminBrokerVisitMapper" >
  <resultMap id="BaseResultMap" type="com.myfun.repository.admindb.po.AdminBrokerVisit" >
    <!--@mbggenerated-->
    <id column="BV_ID" property="bvId" jdbcType="INTEGER" />
    <result column="BV_NAME" property="bvName" jdbcType="VARCHAR" />
    <result column="BV_PHONE" property="bvPhone" jdbcType="VARCHAR" />
    <result column="BV_SEX" property="bvSex" jdbcType="TINYINT" />
    <result column="BV_PROVINCE" property="bvProvince" jdbcType="SMALLINT" />
    <result column="BV_CITY" property="bvCity" jdbcType="SMALLINT" />
    <result column="CITY_NAME" property="cityName" jdbcType="VARCHAR" />
    <result column="BV_QQ" property="bvQq" jdbcType="VARCHAR" />
    <result column="BV_COMP" property="bvComp" jdbcType="VARCHAR" />
    <result column="IS_AVAILABLE" property="isAvailable" jdbcType="TINYINT" />
    <result column="IS_DISPOS" property="isDispos" jdbcType="TINYINT" />
    <result column="IS_SMS" property="isSms" jdbcType="TINYINT" />
    <result column="IS_REG" property="isReg" jdbcType="TINYINT" />
    <result column="REG_SOURCE" property="regSource" jdbcType="TINYINT" />
    <result column="REG_TIME" property="regTime" jdbcType="TIMESTAMP" />
    <result column="CREATOR_COMP" property="creatorComp" jdbcType="INTEGER" />
    <result column="CREATOR_DEPT" property="creatorDept" jdbcType="INTEGER" />
    <result column="CREATOR_UID" property="creatorUid" jdbcType="INTEGER" />
    <result column="CREATOR_TIME" property="creatorTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <resultMap type="com.myfun.repository.admindb.dto.AdminBrokerVisitDto" id="extResultMap" extends="BaseResultMap">
  
  </resultMap>
  <sql id="Base_Column_List" >
    <!--@mbggenerated-->
    BV_ID, BV_NAME, BV_PHONE, BV_SEX, BV_PROVINCE, BV_CITY, CITY_NAME, BV_QQ, BV_COMP, 
    IS_AVAILABLE, IS_DISPOS, IS_SMS, IS_REG, REG_SOURCE, REG_TIME, CREATOR_COMP, CREATOR_DEPT, 
    CREATOR_UID, CREATOR_TIME
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--@mbggenerated-->
    select 
    <include refid="Base_Column_List" />
    from BROKER_VISIT
    where BV_ID = #{bvId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--@mbggenerated-->
    delete from BROKER_VISIT
    where BV_ID = #{bvId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.myfun.repository.admindb.po.AdminBrokerVisit" >
    <!--@mbggenerated-->
    insert into BROKER_VISIT (BV_ID, BV_NAME, BV_PHONE, 
      BV_SEX, BV_PROVINCE, BV_CITY, 
      CITY_NAME, BV_QQ, BV_COMP, 
      IS_AVAILABLE, IS_DISPOS, IS_SMS, 
      IS_REG, REG_SOURCE, REG_TIME, 
      CREATOR_COMP, CREATOR_DEPT, CREATOR_UID, 
      CREATOR_TIME)
    values (#{bvId,jdbcType=INTEGER}, #{bvName,jdbcType=VARCHAR}, #{bvPhone,jdbcType=VARCHAR}, 
      #{bvSex,jdbcType=TINYINT}, #{bvProvince,jdbcType=SMALLINT}, #{bvCity,jdbcType=SMALLINT}, 
      #{cityName,jdbcType=VARCHAR}, #{bvQq,jdbcType=VARCHAR}, #{bvComp,jdbcType=VARCHAR}, 
      #{isAvailable,jdbcType=TINYINT}, #{isDispos,jdbcType=TINYINT}, #{isSms,jdbcType=TINYINT}, 
      #{isReg,jdbcType=TINYINT}, #{regSource,jdbcType=TINYINT}, #{regTime,jdbcType=TIMESTAMP}, 
      #{creatorComp,jdbcType=INTEGER}, #{creatorDept,jdbcType=INTEGER}, #{creatorUid,jdbcType=INTEGER}, 
      #{creatorTime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.myfun.repository.admindb.po.AdminBrokerVisit" >
    <selectKey keyProperty="bvId" order="BEFORE" resultType="java.lang.Integer">
      SELECT isnull(max(BV_ID), 0) +1 from BROKER_VISIT
    </selectKey>
    insert into BROKER_VISIT
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="bvId != null" >
        BV_ID,
      </if>
      <if test="bvName != null" >
        BV_NAME,
      </if>
      <if test="bvPhone != null" >
        BV_PHONE,
      </if>
      <if test="bvSex != null" >
        BV_SEX,
      </if>
      <if test="bvProvince != null" >
        BV_PROVINCE,
      </if>
      <if test="bvCity != null" >
        BV_CITY,
      </if>
      <if test="cityName != null" >
        CITY_NAME,
      </if>
      <if test="bvQq != null" >
        BV_QQ,
      </if>
      <if test="bvComp != null" >
        BV_COMP,
      </if>
      <if test="isAvailable != null" >
        IS_AVAILABLE,
      </if>
      <if test="isDispos != null" >
        IS_DISPOS,
      </if>
      <if test="isSms != null" >
        IS_SMS,
      </if>
      <if test="isReg != null" >
        IS_REG,
      </if>
      <if test="regSource != null" >
        REG_SOURCE,
      </if>
      <if test="regTime != null" >
        REG_TIME,
      </if>
      <if test="creatorComp != null" >
        CREATOR_COMP,
      </if>
      <if test="creatorDept != null" >
        CREATOR_DEPT,
      </if>
      <if test="creatorUid != null" >
        CREATOR_UID,
      </if>
      <if test="creatorTime != null" >
        CREATOR_TIME,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="bvId != null" >
        #{bvId,jdbcType=INTEGER},
      </if>
      <if test="bvName != null" >
        #{bvName,jdbcType=VARCHAR},
      </if>
      <if test="bvPhone != null" >
        #{bvPhone,jdbcType=VARCHAR},
      </if>
      <if test="bvSex != null" >
        #{bvSex,jdbcType=TINYINT},
      </if>
      <if test="bvProvince != null" >
        #{bvProvince,jdbcType=SMALLINT},
      </if>
      <if test="bvCity != null" >
        #{bvCity,jdbcType=SMALLINT},
      </if>
      <if test="cityName != null" >
        #{cityName,jdbcType=VARCHAR},
      </if>
      <if test="bvQq != null" >
        #{bvQq,jdbcType=VARCHAR},
      </if>
      <if test="bvComp != null" >
        #{bvComp,jdbcType=VARCHAR},
      </if>
      <if test="isAvailable != null" >
        #{isAvailable,jdbcType=TINYINT},
      </if>
      <if test="isDispos != null" >
        #{isDispos,jdbcType=TINYINT},
      </if>
      <if test="isSms != null" >
        #{isSms,jdbcType=TINYINT},
      </if>
      <if test="isReg != null" >
        #{isReg,jdbcType=TINYINT},
      </if>
      <if test="regSource != null" >
        #{regSource,jdbcType=TINYINT},
      </if>
      <if test="regTime != null" >
        #{regTime,jdbcType=TIMESTAMP},
      </if>
      <if test="creatorComp != null" >
        #{creatorComp,jdbcType=INTEGER},
      </if>
      <if test="creatorDept != null" >
        #{creatorDept,jdbcType=INTEGER},
      </if>
      <if test="creatorUid != null" >
        #{creatorUid,jdbcType=INTEGER},
      </if>
      <if test="creatorTime != null" >
        #{creatorTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.myfun.repository.admindb.po.AdminBrokerVisit" >
    <!--@mbggenerated-->
    update BROKER_VISIT
    <set >
      <if test="bvName != null" >
        BV_NAME = #{bvName,jdbcType=VARCHAR},
      </if>
      <if test="bvPhone != null" >
        BV_PHONE = #{bvPhone,jdbcType=VARCHAR},
      </if>
      <if test="bvSex != null" >
        BV_SEX = #{bvSex,jdbcType=TINYINT},
      </if>
      <if test="bvProvince != null" >
        BV_PROVINCE = #{bvProvince,jdbcType=SMALLINT},
      </if>
      <if test="bvCity != null" >
        BV_CITY = #{bvCity,jdbcType=SMALLINT},
      </if>
      <if test="cityName != null" >
        CITY_NAME = #{cityName,jdbcType=VARCHAR},
      </if>
      <if test="bvQq != null" >
        BV_QQ = #{bvQq,jdbcType=VARCHAR},
      </if>
      <if test="bvComp != null" >
        BV_COMP = #{bvComp,jdbcType=VARCHAR},
      </if>
      <if test="isAvailable != null" >
        IS_AVAILABLE = #{isAvailable,jdbcType=TINYINT},
      </if>
      <if test="isDispos != null" >
        IS_DISPOS = #{isDispos,jdbcType=TINYINT},
      </if>
      <if test="isSms != null" >
        IS_SMS = #{isSms,jdbcType=TINYINT},
      </if>
      <if test="isReg != null" >
        IS_REG = #{isReg,jdbcType=TINYINT},
      </if>
      <if test="regSource != null" >
        REG_SOURCE = #{regSource,jdbcType=TINYINT},
      </if>
      <if test="regTime != null" >
        REG_TIME = #{regTime,jdbcType=TIMESTAMP},
      </if>
      <if test="creatorComp != null" >
        CREATOR_COMP = #{creatorComp,jdbcType=INTEGER},
      </if>
      <if test="creatorDept != null" >
        CREATOR_DEPT = #{creatorDept,jdbcType=INTEGER},
      </if>
      <if test="creatorUid != null" >
        CREATOR_UID = #{creatorUid,jdbcType=INTEGER},
      </if>
      <if test="creatorTime != null" >
        CREATOR_TIME = #{creatorTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where BV_ID = #{bvId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.myfun.repository.admindb.po.AdminBrokerVisit" >
    <!--@mbggenerated-->
    update BROKER_VISIT
    set BV_NAME = #{bvName,jdbcType=VARCHAR},
      BV_PHONE = #{bvPhone,jdbcType=VARCHAR},
      BV_SEX = #{bvSex,jdbcType=TINYINT},
      BV_PROVINCE = #{bvProvince,jdbcType=SMALLINT},
      BV_CITY = #{bvCity,jdbcType=SMALLINT},
      CITY_NAME = #{cityName,jdbcType=VARCHAR},
      BV_QQ = #{bvQq,jdbcType=VARCHAR},
      BV_COMP = #{bvComp,jdbcType=VARCHAR},
      IS_AVAILABLE = #{isAvailable,jdbcType=TINYINT},
      IS_DISPOS = #{isDispos,jdbcType=TINYINT},
      IS_SMS = #{isSms,jdbcType=TINYINT},
      IS_REG = #{isReg,jdbcType=TINYINT},
      REG_SOURCE = #{regSource,jdbcType=TINYINT},
      REG_TIME = #{regTime,jdbcType=TIMESTAMP},
      CREATOR_COMP = #{creatorComp,jdbcType=INTEGER},
      CREATOR_DEPT = #{creatorDept,jdbcType=INTEGER},
      CREATOR_UID = #{creatorUid,jdbcType=INTEGER},
      CREATOR_TIME = #{creatorTime,jdbcType=TIMESTAMP}
    where BV_ID = #{bvId,jdbcType=INTEGER}
  </update>
  <select id="getBrokerVisit" parameterType="com.myfun.repository.admindb.param.AdminBrokerVisitParam" resultMap="extResultMap">
  	select <include refid="Base_Column_List"/> 
  	from BROKER_VISIT
  	<where>
  			<if test="null != bvProvince">
  				and BV_PROVINCE = #{bvProvince}
  			</if>
  			<if test="null != bvCity">
  				and BV_CITY = #{bvCity}
  			</if>
  			<if test="null != creatorDept">
  				and CREATOR_DEPT = #{creatorDept}
  			</if>
  			<if test="null != isReg">
  				and IS_REG = #{isReg}
  			</if>
  			<if test="null != bvPhone and '' != bvPhone">
  				and BV_PHONE = #{bvPhone}
  			</if>
  			<if test="null != bRegTime and '' != bRegTime">
  				<![CDATA[and CREATOR_TIME >= #{bRegTime}]]>
  			</if>
  			<if test="null != eRegTime and '' != eRegTime">
  				<![CDATA[and CREATOR_TIME <= #{eRegTime}]]>
  			</if>
  			<if test="null != isSms">
  				and IS_SMS = #{isSms}
  			</if>
  			<if test="null != bvSex">
  				and BV_SEX = #{bvSex}
  			</if>
  			<if test="null != isDispos">
  				and IS_DISPOS = #{isDispos}
  			</if>
  			<if test="null != isAvailable">
  				and IS_AVAILABLE = #{isAvailable}
  			</if>
  			<if test="null != crmCompId">
  				and CREATOR_COMP = #{crmCompId}
  			</if>
  	</where>
  	order by CREATOR_TIME desc
  </select>
  
  <select id="getCountCurrentMastTime" parameterType="java.util.Map" resultType="java.lang.Integer">
  		select count(1) from BROKER_VISIT where CREATOR_TIME > #{nowTime} and CREATOR_UID = #{createUid}
  </select>
  <select id="getCountByCondition" resultType="java.lang.Integer" parameterType="com.myfun.repository.admindb.po.AdminBrokerVisit">
  		select count(1) from BROKER_VISIT 
  		<where>
  			<if test="null != bvPhone and '' != bvPhone">
  			 and BV_PHONE = #{bvPhone} 
  			</if>
  		</where>
  </select>

  <update id="updateBrokerVisitByBvPhone" parameterType="com.myfun.repository.admindb.po.AdminBrokerVisit">
    update BROKER_VISIT
    <set >
      <if test="bvName != null" >
        BV_NAME = #{bvName,jdbcType=VARCHAR},
      </if>
      <if test="bvPhone != null" >
        BV_PHONE = #{bvPhone,jdbcType=VARCHAR},
      </if>
      <if test="bvSex != null" >
        BV_SEX = #{bvSex,jdbcType=TINYINT},
      </if>
      <if test="bvProvince != null" >
        BV_PROVINCE = #{bvProvince,jdbcType=SMALLINT},
      </if>
      <if test="bvCity != null" >
        BV_CITY = #{bvCity,jdbcType=SMALLINT},
      </if>
      <if test="cityName != null" >
        CITY_NAME = #{cityName,jdbcType=VARCHAR},
      </if>
      <if test="bvQq != null" >
        BV_QQ = #{bvQq,jdbcType=VARCHAR},
      </if>
      <if test="bvComp != null" >
        BV_COMP = #{bvComp,jdbcType=VARCHAR},
      </if>
      <if test="isAvailable != null" >
        IS_AVAILABLE = #{isAvailable,jdbcType=TINYINT},
      </if>
      <if test="isDispos != null" >
        IS_DISPOS = #{isDispos,jdbcType=TINYINT},
      </if>
      <if test="isSms != null" >
        IS_SMS = #{isSms,jdbcType=TINYINT},
      </if>
      <if test="isReg != null" >
        IS_REG = #{isReg,jdbcType=TINYINT},
      </if>
      <if test="regSource != null" >
        REG_SOURCE = #{regSource,jdbcType=TINYINT},
      </if>
      <if test="regTime != null" >
        REG_TIME = #{regTime,jdbcType=TIMESTAMP},
      </if>
      <if test="creatorComp != null" >
        CREATOR_COMP = #{creatorComp,jdbcType=INTEGER},
      </if>
      <if test="creatorDept != null" >
        CREATOR_DEPT = #{creatorDept,jdbcType=INTEGER},
      </if>
      <if test="creatorUid != null" >
        CREATOR_UID = #{creatorUid,jdbcType=INTEGER},
      </if>
      <if test="creatorTime != null" >
        CREATOR_TIME = #{creatorTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where BV_PHONE = #{bvPhone,jdbcType=VARCHAR}
  </update>
</mapper>